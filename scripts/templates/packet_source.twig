/**
* LICENSE PLACEHOLDER
*
* @file {{file_name}}.cpp
* @package openpst/libopenpst
* @brief {{description}}
*
* @author Gassan Idriss <ghassani@gmail.com>
*/

#include "{{path}}/{{file_name}}.h"

using namespace OpenPST::{{namespace}};

{{class_name}}::{{class_name}}() : {{extends_class_name}}()
{
{% for field in fields %}
{% if '[]' in field.type %}
	addField("{{field.name}}", kPacketFieldTypeArray, {%if field.size_const %}{{field.size_const}}{%else%}{{field.size}}{%endif%});
{% elseif field.type == 'variable' %}
	addField("{{field.name}}", kPacketFieldTypeVariant, {{field.size}});
{% else %}
	addField("{{field.name}}", kPacketFieldTypePrimitive, sizeof({{field.type}}));
{% endif %}
{% endfor %}

{% for field,val in default_exends %}
{% if field and val %}
	set{{field|to_camel}}({{val}});
{% endif %}
{% endfor %}
{% for field in fields %}
{% if field.default %}
	set{{field.name_camel}}({{field.default}});
{% elseif field.default_string %}
	set{{field.name_camel}}("{{field.default_string}}");
{% endif %}
{% endfor %}
}

{{class_name}}::~{{class_name}}()
{

}

{% for field in fields %}
{% include 'method_get.twig' %}
                
{% include 'method_set.twig' %}
{% endfor %}

{% if unpacked_custom %}
{{unpacked_custom|raw}}
{% else %}
void {{class_name}}::unpack(std::vector<uint8_t>& data)
{
{% if unpack_base %}
	{{extends_class_name}}::unpack(data);
{% endif %}
}
{% endif %}
{% if expects_response %}
void {{class_name}}::prepareResponse()
{
	if (response == nullptr) {
		{{expects_response}}* resp = new {{expects_response}}();
		response = resp;
	}
}
{% endif %}